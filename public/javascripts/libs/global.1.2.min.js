(function(a){function c(){this.currentAjaxState={connection:null,options:{}};this.ajaxFinishBind()}c.prototype.ajaxFinishBind=function(){var a=this;$(document).ajaxSuccess(function(b,d,h){b=$.parseJSON(d.responseText);a.popoutMask();"system"==a.currentAjaxState.options.handleCode&&(400==b.code?alert("\u63d0\u4ea4\u53c2\u6570\u6709\u8bef, \u8bf7\u8054\u7cfb\u7ba1\u7406\u5458"+b.msg):401==b.code?(alert("\u975e\u6cd5\u8ba4\u8bc1\u8bf7\u6c42, \u8bf7\u91cd\u65b0\u767b\u5f55"),window.top.location.replace(b.msg)):
500==b.code?alert("\u64cd\u4f5c\u5931\u8d25, \u8bf7\u7a0d\u540e\u518d\u8bd5\uff0c\u82e5\u95ee\u9898\u4f9d\u65e7\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458\u89e3\u51b3"):503==b.code?alert("\u7cfb\u7edf\u7e41\u5fd9, \u8bf7\u7a0d\u540e\u518d\u8bd5\uff0c\u82e5\u95ee\u9898\u4f9d\u65e7\u8bf7\u8054\u7cfb\u5ba2\u670d\u89e3\u51b3"):561==b.code&&(alert("\u4f1a\u8bdd\u5df2\u8fc7\u671f, \u8bf7\u91cd\u65b0\u767b\u5f55"),document.location.replace(b.msg)))});$(document).ajaxError(function(b,d,h,e){403==d.status?alert("\u62d2\u7edd\u8bbf\u95ee\uff01\u5982\u679c\u60a8\u4e4b\u524d\u767b\u5f55\u8fc7\u5176\u4ed6\u8d26\u53f7\uff0c\u9700\u8981\u9000\u51fa\u91cd\u65b0\u767b\u5f55"):
404==d.status&&alert("\u7f51\u7edc\u8fde\u63a5\u4e0d\u901a\u6216\u8bbf\u95ee\u5730\u5740\u4e0d\u5b58\u5728");a.popoutMask()});this.log("Tr.ajaxFinishBind")};c.prototype.ajax=function(a,b,d,c,e){var h=$.extend({},{loadingMask:!0,maskDomId:"tr_loading_mask",timeout:2E4,handleCode:"system",timeoutMsg:"\u7f51\u7edc\u8d85\u65f6"},e);this.currentAjaxState.options=h;this.popupMask();for(var k in b)b[k]&&b[k].constructor==String&&(b[k]=$.trim(b[k]));var f=this;this.currentAjaxState.connection=$.ajax({type:c,
url:a,data:$.extend({__ts:(new Date).getTime()},b),dataType:"json",success:function(a,b,e){d(a)},traditional:!0,timeout:h.timeout,complete:function(a,b){"timeout"==b&&(f.currentAjaxState.connection.abort(),h.timeoutMsg&&alert(h.timeoutMsg));f.popoutMask()}})};c.prototype.get=function(a,b,d,c){this.ajax(a,b,d,"GET",c)};c.prototype.post=function(a,b,d,c){var e=$("input[name=authenticityToken]").val();e&&(b=$.extend({authenticityToken:e},b));this.ajax(a,b,d,"POST",c)};c.prototype.popupMask=function(){var a=
this.currentAjaxState.options;a.loadingMask&&this.popup(a.maskDomId)};c.prototype.popoutMask=function(){var a=this.currentAjaxState.options;a.loadingMask&&this.popout(a.maskDomId)};c.prototype.popup=function(a){$("html").addClass("overflow-hidden");$("#"+a).show()};c.prototype.popout=function(a){$("html").removeClass("overflow-hidden");$("#"+a).hide()};c.prototype.log=function(a){window.console&&console.log(a)};var g=new c;a.Tr=g})(this);APP={};
Date.prototype.Format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var g in c)(new RegExp("("+g+")")).test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[g]:("00"+c[g]).substr((""+c[g]).length)));return a};
(function(a){a.fn.trForm=function(c){var g=a.extend({},{before:function(){return!0},get:!1,exParams:{},callback:function(a){return!1}},c);this.each(function(){function c(){var b={};a.each(f,function(d,e){var c=a(e);b[c.attr("tr-param")]=a.trim(void 0!=c.attr("value")?c.val():c.text())});return b}var b=a(this),d=b.attr("tr-url");if(!d)return!0;var f=b.find("[tr-param]"),b=b.find(".trSubmit");if(0==f.length||0==b.length)return Tr.log("\u6ca1\u6709\u53ef\u63d0\u4ea4\u7684\u53c2\u6570\u6216\u8005\u6309\u94ae"),
!0;b.click(function(){var b=a.extend(!0,{},g.exParams);a.each(b,function(a,d){"function"===typeof d&&(b[a]=d.call())});var f=a.extend(c(),b);g.before()&&(g.get?Tr.get(d,f,function(a){g.callback(a)}):Tr.post(d,f,function(a){g.callback(a)}))})})}})(jQuery);
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a){function c(a){a=b.json?JSON.stringify(a):String(a);return b.raw?a:encodeURIComponent(a)}function g(c,f){var e;if(b.raw)e=c;else a:{var d=c;0===d.indexOf('"')&&(d=d.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{d=decodeURIComponent(d.replace(h," "));e=b.json?JSON.parse(d):d;break a}catch(k){}e=void 0}return a.isFunction(f)?f(e):e}var h=/\+/g,b=
a.cookie=function(d,f,e){if(void 0!==f&&!a.isFunction(f)){e=a.extend({},b.defaults,e);if("number"===typeof e.expires){var h=e.expires,k=e.expires=new Date;k.setTime(+k+864E5*h)}return document.cookie=[b.raw?d:encodeURIComponent(d),"=",c(f),e.expires?"; expires="+e.expires.toUTCString():"",e.path?"; path="+e.path:"",e.domain?"; domain="+e.domain:"",e.secure?"; secure":""].join("")}e=d?void 0:{};for(var h=document.cookie?document.cookie.split("; "):[],k=0,n=h.length;k<n;k++){var l=h[k].split("="),m;
m=l.shift();m=b.raw?m:decodeURIComponent(m);l=l.join("=");if(d&&d===m){e=g(l,f);break}d||void 0===(l=g(l))||(e[m]=l)}return e};b.defaults={};a.removeCookie=function(b,c){if(void 0===a.cookie(b))return!1;a.cookie(b,"",a.extend({},c,{expires:-1}));return!a.cookie(b)}});